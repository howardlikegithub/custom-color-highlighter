define(function(e){"use strict";function i(e){e.on("renderLine",this.process.bind(this)),this.process(e,null,e.display.lineDiv)}function r(e,n,t){e.style.backgroundColor=t,e.style.borderRadius="2px",e.style.padding="4px 4px",e.style.fontFamily="Source Code Pro, Helvetica Neue, sans-serif",e.style.fontSize="12px",e.style.textTransform="uppercase",e.style.fontWeight="400",e.style.display="inline-block",e.style.color=n.light()<50?"#fff":"#000"}function l(e){return e=e.trim(),"%"==e[e.length-1]?parseInt(e)/100*255:parseInt(e)}function s(e){return e.nextSibling&&e.nextSibling.nodeValue?e.nextSibling.nodeValue.trim():""}var n=e("color"),t=e("definedcolors");return i.validMode=function(e){return"css"==e||"sass"==e||"text/x-scss"==e||"text/x-less"==e||"text/x-brackets-html"==e||"text/x-styl"==e},i.prototype.process=function(e,i,a){for(var o=a.getElementsByClassName("cm-atom"),x=0;x<o.length;x++){var g,b,f,d,p,S,h,m=o[x],c=null,u="";if(!m.classList.contains("cm-error")){var T=m.innerText.trim();"#"!=T[0]||4!=T.length&&7!=T.length?(T=T.toLowerCase(),"rgb"!=T&&"hsl"!=T||"("!=s(m)||"cm-number"!=(g=m.nextElementSibling).className||","!=s(g)||"cm-number"!=(b=g.nextElementSibling).className||","!=s(b)||"cm-number"!=(f=b.nextElementSibling).className||")"!=s(f)[0]?"rgba"!=T&&"hsla"!=T||"("!=s(m)||"cm-number"!=(g=m.nextElementSibling).className||","!=s(g)||"cm-number"!=(b=g.nextElementSibling).className||","!=s(b)||"cm-number"!=(f=b.nextElementSibling).className||","!=s(f)||"cm-number"!=(d=f.nextElementSibling).className||")"!=s(d)[0]||(c="rgba"==T?new n(l(p=g.innerText),l(S=b.innerText),l(h=f.innerText)):n.fromHSL(parseInt(p=g.innerText),parseInt(S=b.innerText),parseInt(h=f.innerText)),u=m.innerText+m.nextSibling.nodeValue+p+g.nextSibling.nodeValue+S+b.nextSibling.nodeValue+h+f.nextSibling.nodeValue+d.innerText+d.nextSibling.nodeValue.split(")")[0]+")"):(c="rgb"==T?new n(l(p=g.innerText),l(S=b.innerText),l(h=f.innerText)):n.fromHSL(parseInt(p=g.innerText),parseInt(S=b.innerText),parseInt(h=f.innerText)),u=m.innerText+m.nextSibling.nodeValue+p+g.nextSibling.nodeValue+S+b.nextSibling.nodeValue+h+f.nextSibling.nodeValue.split(")")[0]+")"),c&&(m.dataset.color=u,m.classList.add("h-phantom"),r(m,c,c.toHexString()))):(c=n.fromHexString(T),c&&r(m,c,T))}}o=a.getElementsByClassName("cm-keyword");for(var x=0;x<o.length;x++){var m=o[x],T=m.innerText.trim().toLowerCase();T in t&&r(m,t[T],T)}},i});